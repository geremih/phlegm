;(format t "狺泔溴换渝趑轭躔篝蹑鏖翳犰翳蝈玳篝弪犷箬轸ㄤ彐疳蜥礤翦铛礅弪蝈玳篝弪螵辈换泔铘衢铙钺礤镦翳蝈玳篝弪泔铙邃鏖翳铛礅弪殒篚怏泸轲顼弩骝镯瞽ㄤ彐疳蜥礤翦眍屙镱殂螵Ж弪铹à狒à博à穿à俯à俯┅换郁蝓泗麸篝矧蝈玳篝弪溽翎ㄤ彐篝蝓泗蝈玳篝弪吼蜷铘骢钽糸镱灬礅溽篝蝓泗篝蝈犴溴痿瑭ㄤ邈灬蝈ㄩ珙矧溴痿瑭ㄦ矧磲篝蝈犴幄蝈玳篝弪钺礤篝蝓泗┅┅钺礤鲠祯豉疱翦眇铋飑ㄦ蝈蹇舂换涕篝篝矧轭犰翳蝈玳篝弪ㄤ彐鲠蝈玳篝弪扉篝Ж┅幻蝈狒弩扉篝鏖翳犰翳蝈玳篝弪ㄤ镬轶疳螋眍屙镱殂螵ㄩㄣ潋疳螋ㄤ雉轫弩ㄣ潋疳螋┅瘐箬磲脲蝈玳篝弪侯犴ㄣ镱汜翦钺翦篝蜷铉簌礅镬钺礤ㄣ狎疳螋┅黩轸瀛麸篝蜷铉呼疱ㄣ狎疳螋蝈玳篝弪扉篝┅瘐箬磲脲蝈玳篝弪侯犴簌礅镬钺礤ㄣ狎疳螋┅蝈玳篝弪扉篝┅箦翩蝈玳篝弪扉篝蝈鲥蝮蝈玳篝弪扉篝┅花骘蝽狒チ祆蝈玳篝弪祜徜邃アㄤ彐躅珏舡趄狃泔溴ㄦ躅泗轱瞟戾è趄狃泔溴癌簌筱犰扉篝ю蜷铘唛铘ю蜷铘哝祜狒ю蜷铘咪秕忪ю蜷铘唧趄轭蝈徜唛铘蝈徜哝祜狒蝈徜咪秕忪蝈徜唧趄轭筲螂у轸ю蜷铘咩栳蝈徜咩栳ф殪暹镳孱ф殪暹蝈徜ф殪暹黩轸ф殪暹沆矬┅ㄤ镬轶簌簌筱犰趄狃泔溴ㄩ钽趄狃泔溴麒孱ㄥ聃犰骢钽糸镱簌螬蝈趱蝾趄狃泔溴┅┅换蓬鲩蝻铐孱栳骝犴弩鏖翳鲠蜷徕戾轭轸换体犰祜黧戾殂犰筱镳轭麒殂鏖祆忮桢祓骢轭孱鲩蝻铄礤铘换冕忮蝈黩轸翦躞轭骈钿ㄤ彐躅骈钿屙痿舡蝈玳篝弪īㄤ镬轶蝈蝈玳篝弪扉篝麒孱ㄡ钿ㄥ聃犰蝈玳篝弪豉疱蝈绌Г舂蝈玳篝弪骝邋蝈绌蝈趱蝾蝈绌┅ㄤ彐躅翦眇蝈玳篝弪犰祜ㄣ镱篝犷舂戾èㄦ轭洵屙痿舡蝈玳篝弪┅鏖翳秕麴豸麸篝蜷铉篝蝈犴秕麴豸ㄦ矧磲篝蝈犴㈧ア泔铙翎铘┅箦翩蝈玳篝弪鲠祯岍泔铙翎铘蝈玳篝弪翦眇岍蝈玳篝弪骝邋岍铋飑岍ㄤ彐躅骝邋翦眇蝈玳篝弪疳蜥眢⒃犭弩扉篝镦蝈玳篝弪犷骝邋翳矬麒狎翦眇矧狎ㄤ镬轶疳蜥疳蜥眢麒孱ㄡ钿疳蜥蝈玳篝弪翦眇疳蜥愆箦翩蝈玳篝弪骝邋疳蜥愆舂┅ㄤ彐疳蜥礤翦珈镡犰孱鲩蝻铐孱舄Ж┅ㄤ彐躅磲脲骝犴鲠颦鲠飙扉篝Ⅵ狎鲠扉篝轶è鲠鲠祯濠鲠鲠祯濠┊轴祯溴驷蹯趔麸阿戾è骝犴磲脲栳箬翎忪┅ㄤ镬轶鲠颦鲠鲠颦鲠飙扉篝ㄩ扉篝鲠颦鲠飑箦翩ㄧ弭栳箬ㄣ狎鲠颦鲠飑骝犴濠ㄣ潋鲠颦鲠飑箦翩ㄧ弭栳箬鲠颦鲠骝犴濠癌┅┅ㄤ彐疳蜥礤翦痱轫轸轹瀛痱镢邃躜弩Ж┅ㄤ彐躅镳弪狒矧ㄥ痱ㄦ轵篝屮痱┅ㄤ彐躅镳弪犷潴ㄥ痱蝈篝屮痱┅ㄤ彐躅痱轫轸轹瀛痱镢邃躜蹇簌愆礤礅弪簌痱轫轸轹瀛痱镢邃躜弩┅ㄤ彐躅弼犰踽翦ㄥ痱孱雯ㄣ镱è铛礅弪屮痱翦眇蝈玳篝弪犰祜屮痱è蝈玳篝弪屮痱屮痱è扉篝屮痱ㄡ痧禊镳弪犷潴屮痱扉篝镦鲠祯弩镳弪犷潴屮痱孱雯┅┅ㄤ彐躅狃痨ㄦ躅泗疳蜥眢⒃犭弩骢泗轱犷轸疳蜥礤翦蝮犷泔铞弪趔麸狍恝戾è秕麴豸骈钿屙痿舡蝈玳篝弪┅鏖翳秕麴豸麸篝蜷铉秕麴豸ㄦ矧磲⒘哪狺蕃 %" (cons output params) ))
    (free-temp-register params)
    output))

(defun list-of-values (operands env)
  (if (not operands)
      '()
      (cons
       (evaluate (first operands) env)
       (list-of-values (rest operands) env))))




;(format t "Given arguments are &S&" *args*)
(defparameter *output* (make-array 0 
                :element-type 'character 
                :adjustable t 
                :fill-pointer 0))
	

;;Parser
;;parses into a list, PERFECT!
(defun get-file (filename)
  (with-open-file (stream filename)
    (read stream)))


(unless (= 2 (length *args*))
  (error "Incorrect arguments given. Should be of form: %prog input-file output-file"))
(defparameter *code* (get-file (first *args*)))


(evaluate *code* '())
(let ((stream (open (second *args*) :direction :output)))
  (format stream "a" *output*)
  (format t "a" *output*)
  (close stream))

